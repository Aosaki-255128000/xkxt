### **MyBatis 的基本概念**

1. **MyBatis 是什么？**
   - MyBatis 是一个持久层框架（ORM 框架的一种），它可以帮助开发者简化数据库访问操作。通过将 SQL 查询与 Java 方法绑定，开发者无需手动处理繁琐的 JDBC 代码。
   - 它支持动态 SQL、预编译、以及与 Spring 集成的事务管理。
2. **核心功能**
   - **SQL 映射**：将 Java 对象与 SQL 语句绑定，支持 XML 或注解配置。
   - **动态 SQL**：可以在运行时根据条件动态生成 SQL 查询。
   - **结果映射（Result Mapping）**：将查询结果与 Java 对象字段自动对应（通过 `resultMap` 或字段名匹配）。
   - **参数绑定**：通过占位符（`?` 或 `${}`）将方法参数绑定到 SQL 查询中。
   - **插件扩展**：支持开发自定义拦截器，灵活扩展功能。
3. **MyBatis 的核心组件**
   - SqlSessionFactory：
     - 用于创建 `SqlSession` 对象，是 MyBatis 框架的入口。
     - 通常通过 `SqlSessionFactoryBuilder` 创建，基于配置文件或代码形式的数据库配置信息。
   - SqlSession：
     - 核心接口，提供了操作数据库的功能，如增删改查。
     - 每次数据库操作都基于一个 SqlSession。
   - Mapper 接口：
     - 定义了 Java 方法与 SQL 语句的映射关系。
     - 使用时会被 MyBatis 自动生成代理对象。
4. **配置文件**
   - **mybatis-config.xml**：全局配置文件，定义数据源、事务管理、别名、缓存等。
   - **Mapper XML 文件**：定义 SQL 语句及其与方法的映射关系。

------

### **MyBatis 在日志中的应用**

通过日志分析，我们可以看到 MyBatis 的几个核心概念和功能被应用在实际项目中：

#### **1. Mapper 接口的使用**

日志中展示了一个典型的 Mapper 调用过程，例如：

```java
findAllStudentsWithDepartment();
```

- **用途**：开发者调用 `Mapper` 中的方法时，MyBatis 通过代理机制解析方法名，找到对应的 SQL 并执行。
- **位置**：出现在你的项目 `Mapper` 层，负责定义数据库操作。

#### **2. 动态 SQL**

```sql
WHERE s.username LIKE ? AND s.name LIKE ? ...
```

- **用途**：通过传入不同的参数，MyBatis 能动态生成 SQL 语句，避免重复编写多个类似的查询。
- **位置**：Mapper 接口中的方法绑定 XML 文件里的动态 SQL。

#### **3. 结果映射**

```log
<==    Columns: id, username, password, name, role, sex, code, collegeId, phone, birthDate, hometown, departmentId, departmentName
<==        Row: 1, user1, pass1, 张三, student, 男, S20240001, 2, 13800000001, 1999-01-01, 北京市, 2, 通讯学院
```

- **用途**：MyBatis 自动将数据库返回的结果集映射到 Java 对象中，比如将 `id` 映射到 `Student` 的 `id` 属性。
- **位置**：通过 XML 的 `resultMap` 或字段名映射实现，直接反映在查询结果的返回值上。

#### **4. 预编译与参数绑定**

```log
==> Parameters: %%(String), %%(String), %%(String), %%(String), %%(String), 0(Integer), 10(Integer)
```

- **用途**：通过占位符 `?` 进行预编译，避免 SQL 注入，同时将参数绑定到查询中。
- **位置**：Mapper 方法的参数传入时，被 MyBatis 自动绑定到 SQL 占位符中。

#### **5. 事务管理**

```log
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@...] was not registered for synchronization because synchronization is not active
```

- **用途**：SqlSession 的生命周期与事务绑定，当事务未激活时，MyBatis 会独立管理连接。
- **位置**：Spring 的事务管理器中，负责控制 `SqlSession` 的开启与关闭。

------

### **总结：MyBatis 的作用**

在你的项目中，MyBatis 的主要作用可以总结为以下几点：

1. **简化数据库访问逻辑**：将 SQL 与 Java 方法绑定，开发者只需调用方法即可操作数据库。
2. **动态生成查询语句**：通过动态 SQL 支持复杂查询逻辑，减少重复代码。
3. **结果映射**：将查询结果直接映射到 Java 对象中，省去手动解析结果集的繁琐操作。
4. **与 Spring 集成**：通过与 Spring 的无缝结合，实现事务管理和依赖注入。

这使得你的项目在数据库访问层更加高效、灵活，且易于维护。
